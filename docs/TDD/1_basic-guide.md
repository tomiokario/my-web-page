# テスト駆動開発（TDD）基本ガイド

このドキュメントでは、本プロジェクトでテスト駆動開発（TDD）を実践するための基本的なガイドラインを提供します。

## 目次

1. [TDDの基本概念](#tddの基本概念)
2. [テスト環境の構成](#テスト環境の構成)
3. [テストファイルの作成と配置](#テストファイルの作成と配置)
4. [テストの実行方法](#テストの実行方法)
5. [TDDのベストプラクティス](#tddのベストプラクティス)

## TDDの基本概念

テスト駆動開発（TDD）は、以下の「Red-Green-Refactor」サイクルに基づいて開発を進める手法です：

1. **Red**: まず、失敗するテストを書く
   - 実装したい機能に対するテストを先に書く
   - この時点ではテストは失敗する（赤）

2. **Green**: テストが成功するように最小限のコードを実装する
   - テストをパスさせるための最小限のコードを書く
   - この時点でテストは成功する（緑）

3. **Refactor**: コードをリファクタリングする
   - テストが成功している状態を維持しながら、コードを改善する
   - 重複の除去、可読性の向上などを行う

このサイクルを繰り返すことで、テストによって裏付けられた高品質なコードを段階的に構築していきます。

## テスト環境の構成

本プロジェクトでは、以下のテスト環境を使用しています：

- **Jest**: JavaScriptのテストフレームワーク
- **React Testing Library**: Reactコンポーネントのテストユーティリティ
- **jest-dom**: DOMに関する追加のマッチャー

テスト環境の設定は `src/setupTests.js` ファイルで行われています：

```javascript
// jest-dom adds custom jest matchers for asserting on DOM nodes.
import '@testing-library/jest-dom';

// テスト環境のグローバル設定をここに追加できます
```

## テストファイルの作成と配置

### ファイルの配置

テストファイルは `src/__tests__` ディレクトリに配置します：

```
src/
├── __tests__/        # テストファイルを配置するディレクトリ
│   ├── App.test.jsx
│   ├── Footer.test.jsx
│   └── SubHeader.test.jsx
├── components/       # コンポーネントファイル
│   ├── Footer.jsx
│   └── SubHeader.jsx
└── App.jsx           # アプリケーションのルートコンポーネント
```

### 命名規則

テストファイルは、テスト対象のファイル名に `.test.jsx` または `.test.js` を付けて命名します：

- `App.jsx` → `App.test.jsx`
- `Footer.jsx` → `Footer.test.jsx`

## テストの実行方法

### すべてのテストを実行

```bash
npm test
```

### 特定のテストファイルを実行

```bash
npm test src/__tests__/Footer.test.jsx
```

### テストカバレッジを確認

```bash
npm test -- --coverage
```

## TDDのベストプラクティス

### 1. 小さなステップで進める

- 一度に大きな機能を実装しようとせず、小さなステップに分割する
- 各ステップでテスト→実装→リファクタリングのサイクルを回す

### 2. テストファーストを徹底する

- 必ず実装前にテストを書く
- テストが失敗することを確認してから実装に移る

### 3. テストは明確で読みやすく

- テスト名は「何をテストしているか」が明確にわかるようにする
- `describe`と`test`を使って構造化する
- 各テストは独立していて、他のテストに依存しないようにする

### 4. モックは最小限に

- 外部依存関係のみをモックし、テスト対象のコードはモックしない
- モックが多すぎると、実際の動作とテストの乖離が大きくなる

### 5. リファクタリングを怠らない

- テストが通った後は必ずリファクタリングを検討する
- コードの重複、複雑さ、可読性を常に意識する

### 6. テストカバレッジを定期的に確認

- `npm test -- --coverage`でカバレッジを確認
- カバレッジ100%を目指すのではなく、重要な機能や複雑なロジックのカバレッジを優先

---

より詳細な情報は以下のドキュメントを参照してください：

- [コンポーネントテストの書き方](./component-testing.md)
- [外部依存関係を持つコンポーネントのテスト](./testing-with-dependencies.md)

また、以下の外部リソースも参考になります：

- [Jest公式ドキュメント](https://jestjs.io/docs/getting-started)
- [React Testing Library公式ドキュメント](https://testing-library.com/docs/react-testing-library/intro/)
- [Kent C. Dodds氏のTDDに関する記事](https://kentcdodds.com/blog/write-tests)